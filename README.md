# SP_GMod
### Скрипты для работы [Metrostroi](https://github.com/metrostroi-repo/MetrostroiAddon) с тренажером 81-717 (ООО "ПО "Зарница").

Библиотека работает с клиентом и не требует значительных модификаций на серверной стороне.

**`training_scripts`** - Папка аддона для Garry's Mod.  
**`uart_config`** - Папка для конфигурационных файлов. Хранится рядом с `hl2.exe`.  
**`GM_Zarnitsa`** - проект Premake с библиотекой Garry's Mod для работы с тренажером.  
**`Firmwares`** - дамп прошивок Universal CAN Controller v3.2 (STM32F103C8T6), в названии файла указан фактический порядковый номер контроллера. 

Использована библиотека [utf8_to_cp1251](https://github.com/bravikov/utf8_to_cp1251) (Распространяется по лицензии MIT)

# Инициализация проекта
1. Скачать [Premake5](https://premake.github.io/download/)
2. Положить бинарный файл рядом с `premake5.lua`
3. Выполнить команду в папке проекта:
```
premake5 --gmcommon="include/garrysmod_common" vs2022
```
- Для Linux вместо `vs2022` необходимо ввести `gmake`

# Команды для работы с модулем TrainSignals
**Все команды выполняются в консоли клиента.**

`zarn_start [НОМЕР ПОРТА]` - Запуск работы модуля.  
`zarn_stop` - Остановка работы модуля.  
`zarn_force_stop` - Принудительная остановка работы модуля без деконфигурации. 
`zarn_reload [ВЫВОД ИНФОРМАЦИИ]` - Перезагрузка конфигурации (только при остановленной работе модуля!).  

